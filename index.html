<!DOCTYPE html>
<html lang="ko">


<head>
  <link rel="icon" type="image/x-icon" href="android-chrome-512x512.ico">

  <meta charset="UTF-8" />
  <title>ë©˜íŠ¸</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
      background: radial-gradient(circle at top left, #4f46e5 0, #a855f7 35%, #0f172a 100%);
      color: #111827;
    }

    .app-shell {
      width: 100%;
      max-width: 900px;
      background: rgba(248, 250, 252, 0.96);
      border-radius: 20px;
      box-shadow:
        0 18px 45px rgba(15, 23, 42, 0.5),
        0 0 0 1px rgba(148, 163, 184, 0.35);
      padding: 20px 22px;
      backdrop-filter: blur(14px);
      display: flex;
      flex-direction: column;
      gap: 16px;
      animation: fadeIn 0.35s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .app-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      border-bottom: 1px solid rgba(148, 163, 184, 0.4);
      padding-bottom: 10px;
    }

    .title-area {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-dot {
      width: 34px;
      height: 34px;
      border-radius: 999px;
      background: conic-gradient(from 160deg, #4f46e5, #22c55e, #14b8a6, #a855f7, #4f46e5);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 800;
      font-size: 18px;
      box-shadow: 0 0 0 2px rgba(248,250,252,0.9);
    }

    .title-text-main {
      font-size: 18px;
      font-weight: 700;
      color: #020617;
    }

    .title-text-sub {
      font-size: 12px;
      color: #6b7280;
    }

    .badge {
      font-size: 11px;
      padding: 4px 9px;
      border-radius: 999px;
      background: rgba(129, 140, 248, 0.1);
      color: #4338ca;
      border: 1px solid rgba(129, 140, 248, 0.4);
      white-space: nowrap;
    }

    .main-layout {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.1fr);
      gap: 22px;
      margin-top: 4px;
    }

    @media (max-width: 720px) {
      .app-shell {
        padding: 18px 16px 20px;
      }
      .main-layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .panel {
      background: rgba(255, 255, 255, 0.96);
      border-radius: 16px;
      padding: 14px 14px 16px;
      border: 1px solid rgba(226, 232, 240, 0.9);
    }

    .field-group {
      margin-bottom: 14px;
    }

    .field-label {
      font-weight: 600;
      font-size: 13px;
      margin-bottom: 6px;
      display: block;
      color: #111827;
    }

    .hint-text {
      font-size: 11px;
      color: #9ca3af;
      margin-bottom: 8px;
    }

    .button-group {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .segmented-btn {
      flex: 1;
      min-width: 0;
      padding: 8px 10px;
      font-size: 12px;
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      color: #4b5563;
      cursor: pointer;
      text-align: center;
      transition: all 0.15s ease;
      white-space: nowrap;
    }

    .segmented-btn:hover {
      background: #eef2ff;
      border-color: #c7d2fe;
      color: #3730a3;
    }

    .segmented-btn.active {
      background: #4f46e5;
      border-color: #4f46e5;
      color: #ffffff;
      box-shadow: 0 4px 12px rgba(79,70,229,0.4);
    }

    textarea {
      width: 100%;
      padding: 10px 11px;
      font-size: 13px;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      transition: all 0.2s;
      resize: vertical;
      min-height: 140px; /* ğŸ”¹ ë” ë„“ê²Œ */
      font-family: inherit;
    }

    textarea:focus {
      border-color: #6366f1;
      background: #ffffff;
      outline: none;
      box-shadow: 0 0 0 2px rgba(129, 140, 248, 0.2);
    }

    #runButton {
      width: 100%;
      padding: 11px 12px;
      margin-top: 6px;
      border: none;
      border-radius: 999px;
      background: linear-gradient(135deg, #4f46e5, #6366f1);
      color: #ffffff;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.12s ease, box-shadow 0.12s ease, opacity 0.15s;
      box-shadow: 0 8px 16px rgba(79, 70, 229, 0.45);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    #runButton:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 20px rgba(79, 70, 229, 0.55);
    }

    #runButton:active {
      transform: translateY(0);
      box-shadow: 0 6px 12px rgba(79, 70, 229, 0.45);
    }

    #runButton:disabled {
      opacity: 0.6;
      cursor: default;
      box-shadow: none;
      transform: none;
    }

    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }

    .result-title {
      font-weight: 600;
      font-size: 13px;
      color: #111827;
    }

    .copy-btn {
      padding: 5px 10px;
      font-size: 11px;
      border-radius: 999px;
      background: #e5e7eb;
      border: 1px solid #d1d5db;
      cursor: pointer;
      transition: 0.15s;
      color: #374151;
    }

    .copy-btn:hover {
      background: #d1d5db;
    }

    .chat-box {
      background: #f9fafb;
      border-radius: 14px;
      padding: 10px;
      border: 1px solid #e5e7eb;
      min-height: 140px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      overflow: hidden;
    }

    .bubble {
      max-width: 100%;
      padding: 8px 11px;
      border-radius: 14px;
      font-size: 13px;
      white-space: pre-wrap;
      line-height: 1.5;
    }

    .bubble.ai {
      align-self: flex-start;
      background: #eef2ff;
      color: #111827;
      border-bottom-left-radius: 4px;
    }

    .bubble.empty {
      color: #9ca3af;
      background: transparent;
      border-radius: 0;
      padding: 0;
    }

    .bubble-label {
      font-size: 11px;
      color: #9ca3af;
      margin-bottom: 2px;
    }
  </style>
</head>
<body>

  <div class="app-shell">
    <div class="app-header">
      <div class="title-area">
        <div class="logo-dot">W</div>
        <div>
          <div class="title-text-main">ë©˜íŠ¸ ë‹¤ë“¬ê¸° ë„êµ¬</div>
          <div class="title-text-sub">
            ë©˜íŠ¸ë¥¼ ìƒí™©ê³¼ í†¤ì— ë§ê²Œ ì •ë¦¬í•´ì¤˜ìš”.
          </div>
        </div>
      </div>
      <div class="badge">ëŒí”„ ì „ìš©</div>
    </div>

    <div class="main-layout">
      <!-- ì™¼ìª½: ì„¤ì • / ì…ë ¥ -->
      <div class="panel">
        <div class="field-group">
          <span class="field-label">ë©˜íŠ¸ ìœ í˜•</span>
          <div class="button-group" id="typeGroup">
            <button class="segmented-btn type-btn active" data-value="ì²«ì¸ì‚¬">ì²«ì¸ì‚¬</button>
            <button class="segmented-btn type-btn" data-value="ì¤‘ê°„ ë©˜íŠ¸">ì¤‘ê°„ ë©˜íŠ¸</button>
            <button class="segmented-btn type-btn" data-value="ë§ˆë¬´ë¦¬ ë©˜íŠ¸">ë§ˆë¬´ë¦¬ ë©˜íŠ¸</button>
          </div>
        </div>

        <div class="field-group">
          <span class="field-label">í†¤ ëª¨ë“œ</span>
          <div class="button-group" id="toneGroup">
            <button class="segmented-btn tone-btn active" data-value="ë°œë„">ë°œë„ (ë‹¨ì •í•˜ê²Œ ì¹œê·¼)</button>
            <button class="segmented-btn tone-btn" data-value="ì°¨ë¶„">ì°¨ë¶„ (ê³µê°Â·ì‚¬ê³¼ ì¤‘ì‹¬)</button>
          </div>
          <div class="hint-text">
            Â· ë°œë„: ì¼ìƒ ë¬¸ì˜, ê°€ë²¼ìš´ ìƒë‹´<br>
            Â· ì°¨ë¶„: í´ë ˆì„,ì˜ˆë¯¼í•œ ë¬¸ì˜ ëŒ€ì‘
          </div>
        </div>

        <div class="field-group">
          <span class="field-label">[ì„ íƒ] ì±„íŒ… ë‚´ìš©</span>
     
          <textarea
            id="contextText"
            placeholder=""
          ></textarea>
        </div>

        <div class="field-group">
          <span class="field-label"> ë©˜íŠ¸ ì´ˆì•ˆ</span>
          <textarea
            id="inputText"
            placeholder=""
          ></textarea>
        </div>

        <button id="runButton">âœ¨ ë©˜íŠ¸ ë‹¤ë“¬ê¸°</button>
      </div>

      <!-- ì˜¤ë¥¸ìª½: ê²°ê³¼ -->
      <div class="panel">
        <div class="result-header">
          <span class="result-title">ë‹¤ë“¬ì–´ì§„ ë©˜íŠ¸</span>
          <button class="copy-btn" id="copyButton">ë³µì‚¬</button>
        </div>
        <div class="chat-box" id="chatBox">
          <div class="bubble empty">
            ê²°ê³¼ê°€ ì—¬ê¸° ì±„íŒ… ë§í’ì„ ì²˜ëŸ¼ í‘œì‹œë¼ìš” ğŸ™‚
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const runButton = document.getElementById('runButton');
    const copyButton = document.getElementById('copyButton');
    const chatBox = document.getElementById('chatBox');

    const typeButtons = document.querySelectorAll('.type-btn');
    const toneButtons = document.querySelectorAll('.tone-btn');

    const inputTextEl = document.getElementById('inputText');
    const contextTextEl = document.getElementById('contextText');

    // ğŸ” ì—¬ê¸°ì— "ìƒˆë¡œ ë°œê¸‰í•œ" API í‚¤ ë„£ê¸° (ì ˆëŒ€ ì™¸ë¶€ ê³µìœ  X)
    const OPENAI_API_KEY = "";

    // ë²„íŠ¼ ê·¸ë£¹ active í† ê¸€
    function setupToggle(buttons) {
      buttons.forEach(btn => {
        btn.addEventListener('click', () => {
          buttons.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
        });
      });
    }

    setupToggle(typeButtons);
    setupToggle(toneButtons);

    function getActiveValue(buttons) {
      const active = Array.from(buttons).find(b => b.classList.contains('active'));
      return active ? active.getAttribute('data-value') : null;
    }

    // ì±„íŒ… ìŠ¤íƒ€ì¼ ì¤„ë°”ê¿ˆ/ë¬¸ì¥ ë‚˜ëˆ„ê¸° â†’ ë°°ì—´ë¡œ ë°˜í™˜
    function formatChatStyle(text) {
      if (!text) return [];
      text = text.replace(/\r\n/g, '\n').replace(/\r/g, '\n').trim();

      // ì´ë¯¸ ì¤„ë°”ê¿ˆ ìˆìœ¼ë©´ ì¤„ ë‹¨ìœ„ë¡œ ì‚¬ìš©
      if (text.includes('\n')) {
        return text
          .split('\n')
          .map(s => s.trim())
          .filter(Boolean);
      }

      const sentences = [];
      let current = "";

      for (const ch of text) {
        current += ch;
        // ë¬¸ì¥ë¶€í˜¸ ë˜ëŠ” ê¸¸ì´ ê¸°ì¤€ìœ¼ë¡œ ëŠê¸°
        if (/[.!?ï¼ï¼Ÿã€‚]/.test(ch) || current.length >= 20) {
          sentences.push(current.trim());
          current = "";
        }
      }
      if (current.trim()) {
        sentences.push(current.trim());
      }

      return sentences;
    }

    function renderBubbles(lines) {
      chatBox.innerHTML = "";

      if (!lines || lines.length === 0) {
        const empty = document.createElement("div");
        empty.className = "bubble empty";
        empty.textContent = "ê²°ê³¼ê°€ ì—¬ê¸° ì±„íŒ… ë§í’ì„ ì²˜ëŸ¼ í‘œì‹œë¼ìš” ğŸ™‚";
        chatBox.appendChild(empty);
        return;
      }

      const label = document.createElement("div");
      label.className = "bubble-label";
      label.textContent = "AI ì •ë¦¬ ë©˜íŠ¸";
      chatBox.appendChild(label);

      const bubble = document.createElement("div");
      bubble.className = "bubble ai";
      bubble.textContent = lines.join("\n");
      chatBox.appendChild(bubble);
    }

    async function polishText() {
      const type = getActiveValue(typeButtons);
      const tone = getActiveValue(toneButtons);
      const inputText = inputTextEl.value.trim();
      const contextText = contextTextEl.value.trim();

      if (!inputText) {
        alert("ë³´ë‚´ë ¤ëŠ” ë©˜íŠ¸ ì´ˆì•ˆì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        return;
      }

      if (!type || !tone) {
        alert("ë©˜íŠ¸ ìœ í˜•ê³¼ í†¤ ëª¨ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
        return;
      }



      runButton.disabled = true;
      runButton.textContent = "ìƒì„± ì¤‘...";

      const toneInstruction =
        tone === "ë°œë„"
          ? `
- í†¤: ë°œë„
- í† ìŠ¤ ê³ ê°ì„¼í„°ì²˜ëŸ¼ ë‹¨ì •í•˜ì§€ë§Œ ì¹œê·¼í•œ ë§íˆ¬.
- 'ê³ ê°ë‹˜', 'ë„ì™€ë“œë¦¬ë‹¤', 'í™•ì¸í•´ë³´ê³  ì•ˆë‚´ë“œë¦¬ë‹¤' ê°™ì€ í‘œí˜„ ì¤‘ì‹¬.
- ì´ëª¨ì§€ëŠ” ì•„ì´í° ê¸°ë³¸ ì´ëª¨ì§€ ìŠ¤íƒ€ì¼ë¡œ ìì—°ìŠ¤ëŸ½ê²Œ ì—¬ëŸ¬ ê°œ ì‚¬ìš©í•´ë„ ê´œì°®ë‹¤. (ì˜ˆ: ğŸ˜ŠğŸ™‚âœ¨ğŸ’¬ğŸ’¡âœ… ì •ë„)
- ë‹¤ë§Œ ë§ë³´ë‹¤ ì´ëª¨ì§€ê°€ ë” ë§ì•„ì§€ì§€ ì•Šë„ë¡ í•œë‹¤.
- 'ã…‹ã…‹', 'ã…ã…', ê³¼í•œ ë°˜ë§Â·ì¥ë‚œìŠ¤ëŸ¬ìš´ ì–´íˆ¬ëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
          `
          : `
- í†¤: ì°¨ë¶„
- ì˜ˆë¯¼í•˜ê±°ë‚˜ ë¶ˆí¸í•¨ì„ ëŠë¼ëŠ” ê³ ê°ë‹˜ì„ ìƒëŒ€í•œë‹¤ê³  ê°€ì •í•œë‹¤.
- ê³µê°Â·ì‚¬ê³¼ í‘œí˜„ì„ 1ë¬¸ì¥ ì´ìƒ ìì—°ìŠ¤ëŸ½ê²Œ í¬í•¨í•œë‹¤.
  (ì˜ˆ: "ë¶ˆí¸ì„ ê²ªìœ¼ì…¨ì„ ê²ƒ ê°™ì•„ìš”.", "ê±±ì •ë˜ì…¨ì„ í…ë° ì£„ì†¡í•©ë‹ˆë‹¤." ë“±)
- ë§íˆ¬ëŠ” ë˜ë ·í•˜ê³  ë‹¨ì •í•˜ê²Œ, ìµœëŒ€í•œ ì•ˆì •ê° ìˆê²Œ ìœ ì§€í•œë‹¤.
- ì´ëª¨ì§€ëŠ” ì‚¬ìš©í•˜ì§€ ì•Šê±°ë‚˜, ì •ë§ í•„ìš”í•œ ê²½ìš°ì—ë§Œ 1ê°œ ì´ë‚´ë¡œ ì œí•œí•œë‹¤.
          `;

      const contextPart = contextText
        ? `
[ëŒ€í™” ë§¥ë½]
ì•„ë˜ëŠ” ì§€ê¸ˆê¹Œì§€ ê³ ê°ë‹˜ê³¼ ìƒë‹´ì‚¬ê°€ ì£¼ê³ ë°›ì€ ì±„íŒ… ë‚´ìš©ì´ì•¼.
ì´ ë‚´ìš©ì„ ì°¸ê³ í•´ì„œ, ë§¥ë½ì— ë§ëŠ” ë§ˆì§€ë§‰ ë©˜íŠ¸ë§Œ ì •ë¦¬í•´ ì¤˜.

${contextText}
        `.trim()
        : `
[ëŒ€í™” ë§¥ë½]
ë³„ë„ë¡œ ì£¼ì–´ì§„ ì±„íŒ… ë§¥ë½ì€ ì—†ê³ , ë©˜íŠ¸ ì´ˆì•ˆë§Œ ì°¸ê³ í•´ì„œ ì‘ì„±í•´ ì¤˜.
        `.trim();

      const systemMessage = `
ë„ˆëŠ” ê³ ê° ìƒë‹´ ì±„íŒ… ë©˜íŠ¸ë¥¼ ë‹¤ë“¬ëŠ” ë¹„ì„œì•¼.

[ê¸°ë³¸ ê·œì¹™]
- ëª¨ë°”ì¼ ì±„íŒ… ìƒë‹´ ê¸°ì¤€ìœ¼ë¡œ, í•œ ëˆˆì— ì½ê¸° í¸í•´ì•¼ í•œë‹¤.
- ë¬¸ì¥ì€ ì§§ê²Œ(ëŒ€ëµ 8~25ì) ì“°ê³ , ë„ˆë¬´ ê¸¸ë©´ 2ê°œì˜ ë¬¸ì¥ìœ¼ë¡œ ë‚˜ëˆŒ ê²ƒ.
- ê° ë¬¸ì¥ ë’¤ì—ëŠ” ì¤„ë°”ê¿ˆ(ì—”í„°)ì„ ë„£ì–´ ì±„íŒ…ì²˜ëŸ¼ í•œ ì¤„ì”© ë³´ì´ê²Œ í•œë‹¤.
- ì „ì²´ëŠ” ë³´í†µ 2~4ë¬¸ì¥ ì •ë„ë¡œ êµ¬ì„±í•œë‹¤.
- í•„ìš”í•˜ë©´ ì£¼ì œê°€ ë°”ë€ŒëŠ” ì§€ì ì—ì„œ ë¬¸ë‹¨ ì‚¬ì´ì— ë¹ˆ ì¤„ 1ì¤„ì„ ë„£ì–´ë„ ëœë‹¤.
- ì›ë¬¸ì— ìˆëŠ” ì •ë³´, ìˆ«ì, ì¡°ê±´, ì£¼ì˜ì‚¬í•­ì€ ì ˆëŒ€ ë¹¼ì§€ ë§ ê²ƒ.
- ë‚´ìš©ì„ ìš”ì•½í•˜ì§€ ë§ê³ , ì˜ë¯¸ì™€ ë‰˜ì•™ìŠ¤ë¥¼ ìœ ì§€í•˜ë©´ì„œ ìì—°ìŠ¤ëŸ½ê²Œ ì •ë¦¬í•œë‹¤.
- ê´‘ê³  ë¬¸êµ¬ì²˜ëŸ¼ ê³¼ì¥ëœ í‘œí˜„ì€ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
- 'ã…‹ã…‹', 'ã…ã…', ê³¼ë„í•œ ë°˜ë§Â·ì¸í„°ë„· ìŠ¬ë­ì€ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
- ì¡´ëŒ“ë§(ìš”/ì…ë‹ˆë‹¤) ìœ„ì£¼ë¡œ, ìƒë‹´ì‚¬ë‹¤ìš´ ë‹¨ì •í•œ ì–´íˆ¬ë¥¼ ìœ ì§€í•œë‹¤.

[ë©˜íŠ¸ ìœ í˜•ë³„ ê°€ì´ë“œ]
- ì²«ì¸ì‚¬: ì²« ì¸ì‚¬ + ê°„ë‹¨í•œ ì†Œê°œ + ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ ìˆ˜ ìˆëŠ”ì§€ ê°€ë³ê²Œ ë¬¼ì–´ë³¸ë‹¤.
- ì¤‘ê°„ ë©˜íŠ¸: ì§„í–‰ ìƒí™© ì•ˆë‚´, ì¶”ê°€ ì •ë³´ ìš”ì²­, ì„¤ëª…, ì‚¬ê³¼/ê°ì‚¬ ë“±. ì´ë¯¸ ëŒ€í™” ì¤‘ì´ë¼ëŠ” ì „ì œë¡œ, ë‹¤ì‹œ ì¸ì‚¬ë¥¼ ë°˜ë³µí•˜ì§€ ì•ŠëŠ”ë‹¤.
- ë§ˆë¬´ë¦¬ ë©˜íŠ¸: ì˜¤ëŠ˜ ì•ˆë‚´/ì²˜ë¦¬í•œ ë‚´ìš©ì„ ê°„ë‹¨íˆ ì •ë¦¬í•˜ê³ , ë„ì›€ì´ ë˜ì—ˆëŠ”ì§€ ì§šì–´ ì¤€ ë’¤, ì¶”ê°€ ë¬¸ì˜ ê°€ëŠ¥í•˜ë‹¤ëŠ” ë§ê³¼ í•¨ê»˜ ì°¨ë¶„í•˜ê²Œ ì¸ì‚¬ë¡œ ë§ˆë¬´ë¦¬í•œë‹¤.

[í†¤ ëª¨ë“œ ê·œì¹™]
${toneInstruction}

[ì¶œë ¥ í˜•ì‹]
- ì™„ì„±ëœ ìƒë‹´ "ìµœì¢… í•œ ë²ˆ"ì— ë³´ë‚¼ ë©˜íŠ¸ë§Œ ì¶œë ¥í•œë‹¤.
- ê³¼ê±° ëŒ€í™” ì „ì²´ë¥¼ ìš”ì•½í•˜ê±°ë‚˜ ë‹¤ì‹œ ì„¤ëª…í•˜ì§€ ë§ê³ , ë§ˆì§€ë§‰ì— ë³´ë‚¼ ë©˜íŠ¸ì—ë§Œ ì§‘ì¤‘í•œë‹¤.
- ê° ë¬¸ì¥ë§ˆë‹¤ ì¤„ë°”ê¿ˆ(ì—”í„°)ì„ ë„£ì–´ ì±„íŒ…ì²˜ëŸ¼ ë³´ì´ê²Œ í•œë‹¤.
- ë¶ˆí•„ìš”í•œ ì„¤ëª…, ë”°ì˜´í‘œ, ë¨¸ë¦¬ë§(ì˜ˆ: "ìˆ˜ì •ëœ ë©˜íŠ¸:" ë“±)ì€ ë„£ì§€ ì•ŠëŠ”ë‹¤.
      `.trim();

      const userMessage = `
ë©˜íŠ¸ ìœ í˜•: ${type}
í†¤ ëª¨ë“œ: ${tone}

${contextPart}

[ìƒë‹´ì›ì´ ë³´ë‚´ë ¤ëŠ” ë©˜íŠ¸ ì´ˆì•ˆ]
${inputText}
      `.trim();

      try {
        const response = await fetch("https://api.openai.com/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer " + OPENAI_API_KEY
          },
          body: JSON.stringify({
            model: "gpt-4.1-mini",
            messages: [
              { role: "system", content: systemMessage },
              { role: "user", content: userMessage }
            ]
          })
        });

        const data = await response.json();

        if (data.error) {
          console.error("API ì˜¤ë¥˜:", data.error);
          alert("ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + data.error.message);
        } else {
          const raw = data.choices?.[0]?.message?.content?.trim() || "";
          const lines = formatChatStyle(raw);
          renderBubbles(lines);
        }
      } catch (err) {
        console.error("ë„¤íŠ¸ì›Œí¬/ìš”ì²­ ì—ëŸ¬:", err);
        alert("ìš”ì²­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + (err?.message || err));
      } finally {
        runButton.disabled = false;
        runButton.textContent = "âœ¨ ë©˜íŠ¸ ë‹¤ë“¬ê¸°";
      }
    }

    runButton.addEventListener('click', polishText);

    copyButton.addEventListener('click', async () => {
      const bubble = chatBox.querySelector('.bubble.ai');
      const text = bubble?.textContent.trim();
      if (!text) {
        alert("ë³µì‚¬í•  ë©˜íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.");
        return;
      }
      try {
        await navigator.clipboard.writeText(text);
        alert("ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
      } catch (e) {
        alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì§ì ‘ ë³µì‚¬í•´ì£¼ì„¸ìš”.");
      }
    });
  </script>

</body>
</html>








